<div class="p-8 max-w-4xl mx-auto animate-fade-in">
    <!-- Page Header -->
    <div class="mb-8">
        <button class="flex items-center gap-2 px-4 py-2 text-slate-400 hover:text-white hover:bg-slate-700 
                   rounded-lg transition-all mb-4" (click)="onCancel()">
            <span>‚Üê</span>
            <span>Back</span>
        </button>
        <h1 class="text-4xl font-bold text-white mb-1">
            {{ isEditMode ? 'Edit Task' : 'Create New Task' }}
        </h1>
        <p class="text-slate-400">{{ isEditMode ? 'Update task details' : 'Fill in the details for your new task' }}</p>
    </div>

    <!-- Form Card -->
    <div class="bg-slate-800/60 backdrop-blur-md border border-slate-700/30 rounded-2xl p-8">
        <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="flex flex-col gap-6">

            <!-- Title Field -->
            <div class="relative">
                <label class="block text-sm font-medium text-slate-400 mb-2" for="title">
                    Task Title <span class="text-danger">*</span>
                </label>
                <input type="text" id="title" formControlName="title" placeholder="Enter task title..." class="w-full px-4 py-3 text-base text-white bg-slate-700 border border-slate-600 rounded-xl
                 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all
                 placeholder-slate-500" [class.border-danger]="isFieldInvalid('title')" />
                <span class="text-xs text-danger mt-1 block" *ngIf="isFieldInvalid('title')">
                    {{ getFieldError('title') }}
                </span>
                <span class="absolute right-0 top-0 text-xs text-slate-500">
                    {{ taskForm.get('title')?.value?.length || 0 }}/100
                </span>
            </div>

            <!-- Description Field -->
            <div class="relative">
                <label class="block text-sm font-medium text-slate-400 mb-2" for="description">
                    Description <span class="text-danger">*</span>
                </label>
                <textarea id="description" formControlName="description" placeholder="Describe your task in detail..."
                    rows="4" class="w-full px-4 py-3 text-base text-white bg-slate-700 border border-slate-600 rounded-xl
                 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all
                 placeholder-slate-500 resize-none" [class.border-danger]="isFieldInvalid('description')"></textarea>
                <span class="text-xs text-danger mt-1 block" *ngIf="isFieldInvalid('description')">
                    {{ getFieldError('description') }}
                </span>
                <span class="absolute right-0 top-0 text-xs text-slate-500">
                    {{ taskForm.get('description')?.value?.length || 0 }}/500
                </span>
            </div>

            <!-- Priority & Status Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Priority Field -->
                <div>
                    <label class="block text-sm font-medium text-slate-400 mb-2">
                        Priority <span class="text-danger">*</span>
                    </label>
                    <div class="flex gap-3">
                        <label *ngFor="let option of priorityOptions" class="flex-1 flex flex-col items-center gap-1 p-4 bg-slate-700 border-2 border-slate-600 
                          rounded-xl cursor-pointer hover:border-primary transition-all"
                            [class.border-primary]="taskForm.get('priority')?.value === option.value"
                            [class.bg-primary/20]="taskForm.get('priority')?.value === option.value">
                            <input type="radio" formControlName="priority" [value]="option.value" class="hidden" />
                            <span class="text-2xl">{{ option.icon }}</span>
                            <span class="text-sm font-medium text-white">{{ option.label }}</span>
                        </label>
                    </div>
                </div>

                <!-- Status Field (Edit mode only) -->
                <div *ngIf="isEditMode">
                    <label class="block text-sm font-medium text-slate-400 mb-2" for="status">Status</label>
                    <select id="status" formControlName="status" class="w-full px-4 py-3 text-base text-white bg-slate-700 border border-slate-600 rounded-xl
                   focus:outline-none focus:border-primary cursor-pointer">
                        <option *ngFor="let option of statusOptions" [value]="option.value">
                            {{ option.label }}
                        </option>
                    </select>
                </div>
            </div>

            <!-- Due Date Field -->
            <div>
                <label class="block text-sm font-medium text-slate-400 mb-2" for="dueDate">
                    Due Date <span class="text-danger">*</span>
                </label>
                <input type="date" id="dueDate" formControlName="dueDate" class="w-full px-4 py-3 text-base text-white bg-slate-700 border border-slate-600 rounded-xl
                 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all"
                    [class.border-danger]="isFieldInvalid('dueDate')" />
                <span class="text-xs text-danger mt-1 block" *ngIf="isFieldInvalid('dueDate')">
                    {{ getFieldError('dueDate') }}
                </span>
            </div>

            <!-- Tags Field -->
            <div>
                <label class="block text-sm font-medium text-slate-400 mb-2">
                    Tags <span class="text-slate-500 font-normal">({{ tags.length }}/5)</span>
                </label>
                <div class="flex flex-wrap gap-2">
                    <div *ngFor="let tag of tags.controls; let i = index"
                        class="flex items-center bg-slate-700 border border-slate-600 rounded-xl overflow-hidden">
                        <input type="text" [formControl]="$any(tag)" placeholder="Tag name"
                            class="w-28 px-3 py-2 bg-transparent border-none outline-none text-sm text-white" />
                        <button type="button" class="px-2 py-2 text-slate-500 hover:text-danger transition-colors"
                            (click)="removeTag(i)">
                            ‚úï
                        </button>
                    </div>

                    <button type="button" class="flex items-center gap-2 px-4 py-2 text-slate-400 hover:text-white 
                         hover:bg-slate-700 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                        (click)="addTag()" [disabled]="tags.length >= 5">
                        <span>Ôºã</span>
                        <span>Add Tag</span>
                    </button>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="flex justify-end gap-4 pt-6 border-t border-slate-700">
                <button type="button"
                    class="px-6 py-3 text-slate-400 hover:text-white hover:bg-slate-700 rounded-xl transition-all"
                    (click)="onReset()">
                    Reset
                </button>
                <button type="button" class="px-6 py-3 bg-slate-700 text-white border border-slate-600 rounded-xl
                       hover:bg-slate-600 hover:border-primary transition-all" (click)="onCancel()">
                    Cancel
                </button>
                <button type="submit" class="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-primary to-primary-dark 
                       text-white font-medium rounded-xl shadow-lg shadow-primary/40 
                       hover:-translate-y-0.5 hover:shadow-xl transition-all disabled:opacity-50"
                    [disabled]="isSubmitting">
                    <span *ngIf="isSubmitting"
                        class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></span>
                    <span>{{ isEditMode ? 'Update Task' : 'Create Task' }}</span>
                </button>
            </div>
        </form>
    </div>

    <!-- Tips Card -->
    <div class="mt-6 bg-slate-800/60 backdrop-blur-md border border-slate-700/30 rounded-2xl p-6">
        <h4 class="text-white font-medium mb-4">üìù Tips</h4>
        <ul class="space-y-2">
            <li
                class="text-sm text-slate-400 pl-6 relative before:content-['‚Ä¢'] before:absolute before:left-2 before:text-primary">
                Use clear, actionable titles
            </li>
            <li
                class="text-sm text-slate-400 pl-6 relative before:content-['‚Ä¢'] before:absolute before:left-2 before:text-primary">
                Add detailed descriptions for complex tasks
            </li>
            <li
                class="text-sm text-slate-400 pl-6 relative before:content-['‚Ä¢'] before:absolute before:left-2 before:text-primary">
                Set realistic due dates
            </li>
            <li
                class="text-sm text-slate-400 pl-6 relative before:content-['‚Ä¢'] before:absolute before:left-2 before:text-primary">
                Use tags to categorize and find tasks easily
            </li>
        </ul>
    </div>
</div>